const e=e=>typeof e,l="",t=e(l),n=e(!0),a=e(0),s=e(e),r="type",o="default",u="Listener",i="Has",c="Ids",d="Table",v=d+"s",g=d+c,h="Row",b=h+"Count",C=h+c,f="Cell",T=f+c,w="Value",V=w+"s",p=w+c,I=e=>l+e,y=(e,l)=>e.startsWith(l),M=(e,l)=>e.endsWith(l),R=(e,t=l,n)=>e.split(t,n),S=globalThis,m=Math,L=m.max,H=m.floor,E=isFinite,J=e=>null==e,D=(e,l,t)=>J(e)?null==t?void 0:t():l(e),F=e=>e==t||e==n,O=l=>e(l)==s,x=e=>Array.isArray(e),z=(e,l,t)=>e.slice(l,t),A=e=>e.length,P=(e,l)=>e.forEach(l),W=(e,l)=>e.map(l),k=(e,l,t)=>e.reduce(l,t),N=(e,...l)=>e.push(...l),j=Object,U=e=>j.getPrototypeOf(e),_=j.entries,q=j.isFrozen,B=e=>!J(e)&&D(U(e),(e=>e==j.prototype||J(U(e))),(()=>!0)),G=j.keys,K=j.freeze,Q=(e=[])=>j.fromEntries(e),X=(e,l)=>l in e,Y=(e,l)=>(delete e[l],e),Z=(e,l)=>P(_(e),(([e,t])=>l(t,e))),$=(e,l)=>Q(((e,l)=>W(_(e),(([e,t])=>l(t,e))))(e,((e,t)=>[t,l(e,t)]))),ee=e=>B(e)&&0==(e=>A(G(e)))(e),le=(e,l,t)=>(X(e,l)||(e[l]=t()),e[l]),te=(e,l,t,n=0)=>J(e)||!B(e)||!n&&ee(e)||q(e)?(null==t||t(),!1):(Z(e,((t,n)=>{l(t,n)||Y(e,n)})),!!n||!ee(e)),ne=e=>new Set(x(e)||J(e)?e:[e]),ae=(e,l)=>null==e?void 0:e.add(l),se=e=>l=>k(ve(l),((l,t)=>l+e(t)),0),re=e=>{var l;return null!=(l=null==e?void 0:e.size)?l:0},oe=se(re),ue=se(oe),ie=se(ue),ce=(e,l)=>{var t;return null!=(t=null==e?void 0:e.has(l))&&t},de=e=>J(e)||0==re(e),ve=e=>{var l;return[...null!=(l=null==e?void 0:e.values())?l:[]]},ge=e=>e.clear(),he=(e,l)=>null==e?void 0:e.forEach(l),be=(e,l)=>null==e?void 0:e.delete(l),Ce=e=>new Map(e),fe=e=>{var l;return[...null!=(l=null==e?void 0:e.keys())?l:[]]},Te=(e,l)=>null==e?void 0:e.get(l),we=(e,l)=>he(e,((e,t)=>l(t,e))),Ve=(e,l,t)=>J(t)?(be(e,l),e):null==e?void 0:e.set(l,t),pe=(e,l,t,n)=>(ce(e,l)?null==n||n(Te(e,l)):Ve(e,l,t()),Te(e,l)),Ie=(e,l,t,n=Ve)=>($(l,((l,n)=>t(e,n,l))),we(e,(t=>X(l,t)?0:n(e,t))),e),ye=(e,l,t,n)=>{const a={};return he(e,((e,s)=>{if(!(null==t?void 0:t(e,s))){const t=l?l(e,s):e;(null==n?void 0:n(t))||(a[s]=t)}})),a},Me=(e,l,t)=>ye(e,(e=>ye(e,l,t)),de,ee),Re=(e,l,t)=>ye(e,(e=>Me(e,l,t)),de,ee),Se=(e,l)=>{const t=Ce();return he(e,((e,n)=>{var a;return t.set(n,null!=(a=null==l?void 0:l(e))?a:e)})),t},me=e=>Se(e,Se),Le=e=>Se(e,me),He=(e,l,t,n,a=0)=>D((t?pe:Te)(e,l[a],a>A(l)-2?t:Ce),(s=>{if(a>A(l)-2)return(null==n?void 0:n(s))&&Ve(e,l[a]),s;const r=He(s,l,t,n,a+1);return de(s)&&Ve(e,l[a]),r})),Ee=new S.TextEncoder,Je=e=>{let l=2166136261;return P(Ee.encode(e),(e=>{l^=e,l+=(l<<1)+(l<<4)+(l<<7)+(l<<8)+(l<<24)})),l>>>0},De=([e,l])=>Oe(e,l),Fe=([e,l,t])=>[e,l,t],Oe=(e,l)=>l?[e,l]:[e],xe=(e,l,t)=>[e,l,t],ze=e=>e[2],Ae=(e,l)=>Je(e+":"+l),Pe=(e,l)=>l>e?(e?Je(e):0)^Je(l):0,We=(e,l)=>{var t;return null!=(t=(null!=e?e:"")>(null!=l?l:"")?e:l)?t:""},ke=(e,l,t)=>{l>e[1]&&(e[1]=l),e[2]=t>>>0},Ne=(e=l)=>Oe(Q(),e),je=(e=l)=>[Ce(),e,0],Ue=([e,l,t],n=Fe)=>[ye(e,n),l,t],_e=([e,l],t=De)=>Oe(ye(e,t),l),qe=(l,n)=>{return x(l)&&3==A(l)&&(s=l[1],e(s)==t)&&e(l[2])==a&&E(l[2])&&n(l[0]);var s},Be=/^\d+$/,Ge=()=>{const e=[];let t=0;return[n=>{var a;return null!=(a=n?e.shift():null)?a:l+t++},l=>{Be.test(l)&&A(e)<1e3&&N(e,l)}]},Ke=e=>[e,e],Qe=(e,l=oe)=>l(e[0])+l(e[1]),Xe=()=>[Ce(),Ce()],Ye=e=>[...e],Ze=([e,l])=>e===l,$e=l=>{const t=e(l);return F(t)||t==a&&E(l)?t:void 0},el=e=>J(e)||!J($e(e)),ll=(e,l,t,n,a)=>J(a)?e.delCell(l,t,n,!0):e.setCell(l,t,n,a),tl=(e,l,t)=>J(t)?e.delValue(l):e.setValue(l,t),nl=JSON.stringify,al=JSON.parse,sl=e=>nl(e,((e,l)=>l instanceof Map?j.fromEntries([...l]):l)),rl=R("-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz"),ol=Ce(W(rl,((e,l)=>[e,l]))),ul=e=>rl[63&e],il=(e,l)=>{var t;return null!=(t=Te(ol,e[l]))?t:0},cl=S.crypto?e=>S.crypto.getRandomValues(e):e=>W(e,(()=>H(256*m.random()))),dl=(e,l,t)=>Ve(e,l,Te(e,l)==-t?void 0:t),vl=()=>{let e,t,n=!1,s=!1,c=0,y=[];const M=Ce(),R=Ce(),S=Ce(),m=Ce(),L=Ce(),H=Ce(),E=Ce(),k=Ce(),j=Ce(),U=Ce(),_=Ce(),q=Ce(),B=Ce(),G=Ce(),Q=ne(),Z=Ce(),le=Ce(),se=Ce(),ve=Ce(),Ee=Xe(),Je=Xe(),De=Xe(),Fe=Xe(),Oe=Xe(),xe=Xe(),ze=Xe(),Ae=Xe(),Pe=Xe(),We=Xe(),ke=Xe(),Ne=Xe(),je=Xe(),Ue=Xe(),_e=Xe(),qe=Xe(),Be=Xe(),el=Xe(),nl=Xe(),rl=Xe(),ol=Xe(),ul=Xe(),il=Ce(),cl=Xe(),[gl,hl,bl,Cl]=(()=>{let e;const[t,n]=Ge(),a=Ce();return[(n,s,r,o=[],u=()=>[])=>{null!=e||(e=zt);const i=t(1);return Ve(a,i,[n,s,r,o,u]),ae(He(s,null!=r?r:[l],ne),i),i},(t,n,...s)=>P(((e,t=[l])=>{const n=[],a=(e,l)=>l==A(t)?N(n,e):null===t[l]?he(e,(e=>a(e,l+1))):P([t[l],null],(t=>a(Te(e,t),l+1)));return a(e,0),n})(t,n),(l=>he(l,(l=>Te(a,l)[0](e,...null!=n?n:[],...s))))),e=>D(Te(a,e),(([,t,s])=>(He(t,null!=s?s:[l],void 0,(l=>(be(l,e),de(l)?1:0))),Ve(a,e),n(e),s))),l=>D(Te(a,l),(([l,,t=[],n,a])=>{const s=(...r)=>{var o,u;const i=A(r);i==A(t)?l(e,...r,...a(r)):J(t[i])?P(null!=(u=null==(o=n[i])?void 0:o.call(n,...r))?u:[],(e=>s(...r,e))):s(...r,t[i])};s()}))]})(),fl=e=>{if(!te(e,((e,l)=>[r,o].includes(l))))return!1;const l=e[r];return!(!F(l)&&l!=a||($e(e[o])!=l&&Y(e,o),0))},Tl=x,wl=(l,t)=>(!e||ce(_,t)||Kl(t))&&te(l,((e,l)=>Vl(t,l,e)),(()=>Kl(t))),Vl=(e,l,t,n)=>te(n?t:Ml(t,e,l),((n,a)=>D(pl(e,l,a,n),(e=>(t[a]=e,!0)),(()=>!1))),(()=>Kl(e,l))),pl=(l,t,n,a)=>e?D(Te(Te(_,l),n),(e=>$e(a)!=e[r]?Kl(l,t,n,a,e[o]):a),(()=>Kl(l,t,n,a))):J($e(a))?Kl(l,t,n,a):a,Il=(e,l)=>te(l?e:Rl(e),((l,t)=>D(yl(t,l),(l=>(e[t]=l,!0)),(()=>!1))),(()=>Ql())),yl=(e,l)=>t?D(Te(B,e),(t=>$e(l)!=t[r]?Ql(e,l,t[o]):l),(()=>Ql(e,l))):J($e(l))?Ql(e,l):l,Ml=(e,l,t)=>(D(Te(q,l),(([n,a])=>{he(n,((l,t)=>{X(e,t)||(e[t]=l)})),he(a,(n=>{X(e,n)||Kl(l,t,n)}))})),e),Rl=e=>(t&&(he(G,((l,t)=>{X(e,t)||(e[t]=l)})),he(Q,(l=>{X(e,l)||Ql(l)}))),e),Sl=e=>Ie(_,e,((e,l,t)=>{const n=Ce(),a=ne();Ie(pe(_,l,Ce),t,((e,l,t)=>{Ve(e,l,t),D(t[o],(e=>Ve(n,l,e)),(()=>ae(a,l)))})),Ve(q,l,[n,a])}),((e,l)=>{Ve(_,l),Ve(q,l)})),ml=e=>Ie(B,e,((e,l,t)=>{Ve(B,l,t),D(t[o],(e=>Ve(G,l,e)),(()=>ae(Q,l)))}),((e,l)=>{Ve(B,l),Ve(G,l),be(Q,l)})),Ll=e=>ee(e)?mt():It(e),Hl=e=>Ie(se,e,((e,l,t)=>El(l,t)),((e,l)=>Pl(l))),El=(e,l)=>Ie(pe(se,e,(()=>(jl(e,1),Ve(Z,e,Ge()),Ve(le,e,Ce()),Ce()))),l,((l,t,n)=>Jl(e,l,t,n)),((l,t)=>Wl(e,l,t))),Jl=(e,l,t,n,a)=>Ie(pe(l,t,(()=>(Ul(e,t,1),Ce()))),n,((l,n,a)=>Dl(e,t,l,n,a)),((n,s)=>kl(e,l,t,n,s,a))),Dl=(e,l,t,n,a)=>{ce(t,n)||_l(e,l,n,1);const s=Te(t,n);a!==s&&(ql(e,l,n,s,a),Ve(t,n,a))},Fl=(e,l,t,n,a)=>D(Te(l,t),(l=>Dl(e,t,l,n,a)),(()=>Jl(e,l,t,Ml({[n]:a},e,t)))),Ol=e=>ee(e)?Et():yt(e),xl=e=>Ie(ve,e,((e,l,t)=>zl(l,t)),((e,l)=>Nl(l))),zl=(e,l)=>{ce(ve,e)||Bl(e,1);const t=Te(ve,e);l!==t&&(Gl(e,t,l),Ve(ve,e,l))},Al=e=>{var l;return null!=(l=Te(se,e))?l:El(e,{})},Pl=e=>El(e,{}),Wl=(e,l,t)=>{const[,n]=Te(Z,e);n(t),Jl(e,l,t,{},!0)},kl=(e,l,t,n,a,s)=>{var r;const o=Te(null==(r=Te(q,e))?void 0:r[0],a);if(!J(o)&&!s)return Dl(e,t,n,a,o);const u=l=>{ql(e,t,l,Te(n,l)),_l(e,t,l,-1),Ve(n,l)};J(o)?u(a):we(n,u),de(n)&&(Ul(e,t,-1),de(Ve(l,t))&&(jl(e,-1),Ve(se,e),Ve(Z,e),Ve(le,e)))},Nl=e=>{const l=Te(G,e);if(!J(l))return zl(e,l);Gl(e,Te(ve,e)),Bl(e,-1),Ve(ve,e)},jl=(e,l)=>dl(M,e,l),Ul=(e,l,t)=>dl(pe(m,e,Ce),l,t)&&Ve(S,e,pe(S,e,(()=>0))+t),_l=(e,l,t,n)=>{var a;const s=Te(le,e),r=null!=(a=Te(s,t))?a:0;(0==r&&1==n||1==r&&-1==n)&&dl(pe(R,e,Ce),t,n),Ve(s,t,r!=-n?r+n:null),dl(pe(pe(L,e,Ce),l,Ce),t,n)},ql=(e,l,t,n,a)=>{var s;pe(pe(pe(H,e,Ce),l,Ce),t,(()=>[n,0]))[1]=a,null==(s=y[3])||s.call(y,e,l,t,a)},Bl=(e,l)=>dl(E,e,l),Gl=(e,l,t)=>{var n;pe(k,e,(()=>[l,0]))[1]=t,null==(n=y[4])||n.call(y,e,t)},Kl=(e,l,t,n,a)=>(N(pe(pe(pe(j,e,Ce),l,Ce),t,(()=>[])),n),a),Ql=(e,l,t)=>(N(pe(U,e,(()=>[])),l),t),Xl=(e,l,t)=>D(Te(Te(Te(H,e),l),t),(([e,l])=>[!0,e,l]),(()=>[!1,...Ke(dt(e,l,t))])),Yl=e=>D(Te(k,e),(([e,l])=>[!0,e,l]),(()=>[!1,...Ke(ht(e))])),Zl=e=>de(j)||de(qe[e])?0:he(e?Le(j):j,((l,t)=>he(l,((l,n)=>he(l,((l,a)=>hl(qe[e],[t,n,a],l))))))),$l=e=>de(U)||de(Be[e])?0:he(e?Se(U):U,((l,t)=>hl(Be[e],[t],l))),et=(e,l,t,n)=>{if(!de(e))return hl(l,n,(()=>ye(e))),we(e,((e,l)=>hl(t,[...null!=n?n:[],e],1==l))),1},lt=e=>{const l=bt();l!=n&&hl(Ee[e],void 0,l);const t=de(We[e]),a=de(je[e])&&de(Ue[e])&&de(Pe[e])&&de(ke[e])&&de(xe[e])&&de(ze[e])&&de(Ae[e])&&t&&de(De[e])&&de(Fe[e]),s=de(_e[e])&&de(Ne[e])&&de(Oe[e])&&de(Je[e]);if(!a||!s){const l=e?[Se(M),me(R),Se(S),me(m),Le(L),Le(H)]:[M,R,S,m,L,H];if(!a){et(l[0],De[e],Fe[e]),he(l[1],((l,t)=>et(l,xe[e],ze[e],[t]))),he(l[2],((l,t)=>{0!=l&&hl(Ae[e],[t],ot(t))}));const n=ne();he(l[3],((l,a)=>{et(l,Pe[e],ke[e],[a])&&!t&&(hl(We[e],[a,null]),ae(n,a))})),t||he(l[5],((l,t)=>{if(!ce(n,t)){const n=ne();he(l,(e=>he(e,(([l,t],a)=>t!==l?ae(n,a):be(e,a))))),he(n,(l=>hl(We[e],[t,l])))}})),he(l[4],((l,t)=>he(l,((l,n)=>et(l,je[e],Ue[e],[t,n])))))}if(!s){let t;he(l[5],((l,n)=>{let a;he(l,((l,s)=>{let r;he(l,(([l,o],u)=>{o!==l&&(hl(_e[e],[n,s,u],o,l,Xl),t=a=r=1)})),r&&hl(Ne[e],[n,s],Xl)})),a&&hl(Oe[e],[n],Xl)})),t&&hl(Je[e],void 0,Xl)}}},tt=e=>{const l=Vt();l!=s&&hl(el[e],void 0,l);const t=de(rl[e])&&de(ol[e]),n=de(ul[e])&&de(nl[e]);if(!t||!n){const l=e?[Se(E),Se(k)]:[E,k];if(t||et(l[0],rl[e],ol[e]),!n){let t;he(l[1],(([l,n],a)=>{n!==l&&(hl(ul[e],[a],n,l,Yl),t=1)})),t&&hl(nl[e],void 0,Yl)}}},nt=(e,...l)=>(Ft((()=>e(...W(l,I)))),zt),at=()=>Re(se),st=()=>fe(se),rt=e=>fe(Te(le,I(e))),ot=e=>re(Te(se,I(e))),ut=e=>fe(Te(se,I(e))),it=(e,l,t,n=0,a)=>{return W(z((r=Te(se,I(e)),o=(e,t)=>[J(l)?t:Te(e,I(l)),t],s=([e],[l])=>{return((null!=(n=e)?n:0)<(null!=(a=l)?a:0)?-1:1)*(t?-1:1);var n,a},W([...null!=(u=null==r?void 0:r.entries())?u:[]],(([e,l])=>o(l,e))).sort(s)),n,J(a)?a:n+a),(([,e])=>e));var s,r,o,u},ct=(e,l)=>fe(Te(Te(se,I(e)),I(l))),dt=(e,l,t)=>Te(Te(Te(se,I(e)),I(l)),I(t)),vt=()=>ye(ve),gt=()=>fe(ve),ht=e=>Te(ve,I(e)),bt=()=>!de(se),Ct=e=>ce(se,I(e)),ft=(e,l)=>ce(Te(le,I(e)),I(l)),Tt=(e,l)=>ce(Te(se,I(e)),I(l)),wt=(e,l,t)=>ce(Te(Te(se,I(e)),I(l)),I(t)),Vt=()=>!de(ve),pt=e=>ce(ve,I(e)),It=e=>nt((()=>(e=>te(e,wl,Kl))(e)?Hl(e):0)),yt=e=>nt((()=>Il(e)?xl(e):0)),Mt=e=>{try{Ll(al(e))}catch(e){}return zt},Rt=l=>nt((()=>{if((e=te(l,(e=>te(e,fl))))&&(Sl(l),!de(se))){const e=at();mt(),It(e)}})),St=e=>nt((()=>{if(t=(e=>te(e,fl))(e)){const l=vt();Dt(),Et(),t=!0,ml(e),yt(l)}})),mt=()=>nt((()=>Hl({}))),Lt=e=>nt((e=>ce(se,e)?Pl(e):0),e),Ht=(e,l)=>nt(((e,l)=>D(Te(se,e),(t=>ce(t,l)?Wl(e,t,l):0))),e,l),Et=()=>nt((()=>xl({}))),Jt=()=>nt((()=>{Sl({}),e=!1})),Dt=()=>nt((()=>{ml({}),t=!1})),Ft=(e,l)=>{if(-1!=c){Ot();const t=e();return xt(l),t}},Ot=()=>{var e;return-1!=c&&c++,1==c&&(null==(e=y[0])||e.call(y),hl(il)),zt},xt=e=>{var l,t;return c>0&&(c--,0==c&&(c=1,Zl(1),de(H)||lt(1),$l(1),de(k)||tt(1),(null==e?void 0:e(zt))&&(he(H,((e,l)=>he(e,((e,t)=>he(e,(([e],n)=>ll(zt,l,t,n,e))))))),ge(H),he(k,(([e],l)=>tl(zt,l,e))),ge(k)),hl(cl[0],void 0),c=-1,Zl(0),de(H)||lt(0),$l(0),de(k)||tt(0),null==(l=y[1])||l.call(y),hl(cl[1],void 0),null==(t=y[2])||t.call(y),c=0,n=bt(),s=Vt(),P([M,R,S,m,L,H,j,E,k,U],ge))),zt},zt={getContent:()=>[at(),vt()],getTables:at,getTableIds:st,getTable:e=>Me(Te(se,I(e))),getTableCellIds:rt,getRowCount:ot,getRowIds:ut,getSortedRowIds:it,getRow:(e,l)=>ye(Te(Te(se,I(e)),I(l))),getCellIds:ct,getCell:dt,getValues:vt,getValueIds:gt,getValue:ht,hasTables:bt,hasTable:Ct,hasTableCell:ft,hasRow:Tt,hasCell:wt,hasValues:Vt,hasValue:pt,getTablesJson:()=>sl(se),getValuesJson:()=>sl(ve),getJson:()=>sl([se,ve]),getTablesSchemaJson:()=>sl(_),getValuesSchemaJson:()=>sl(B),getSchemaJson:()=>sl([_,B]),hasTablesSchema:()=>e,hasValuesSchema:()=>t,setContent:e=>nt((()=>{const l=O(e)?e():e;Tl(l)&&(([e,l])=>{(ee(e)?mt:It)(e),(ee(l)?Et:yt)(l)})(l)})),setTables:It,setTable:(e,l)=>nt((e=>wl(l,e)?El(e,l):0),e),setRow:(e,l,t)=>nt(((e,l)=>Vl(e,l,t)?Jl(e,Al(e),l,t):0),e,l),addRow:(e,l,t=!0)=>Ft((()=>{let n;return Vl(e,n,l)&&(e=I(e),Jl(e,Al(e),n=((e,l)=>{const[t]=Te(Z,e);let n;do{n=t(l)}while(ce(Te(se,e),n));return n})(e,t?1:0),l)),n})),setPartialRow:(e,l,t)=>nt(((e,l)=>{if(Vl(e,l,t,1)){const n=Al(e);$(t,((t,a)=>Fl(e,n,l,a,t)))}}),e,l),setCell:(e,l,t,n)=>nt(((e,l,t)=>D(pl(e,l,t,O(n)?n(dt(e,l,t)):n),(n=>Fl(e,Al(e),l,t,n)))),e,l,t),setValues:yt,setPartialValues:e=>nt((()=>Il(e,1)?$(e,((e,l)=>zl(l,e))):0)),setValue:(e,l)=>nt((e=>D(yl(e,O(l)?l(ht(e)):l),(l=>zl(e,l)))),e),applyChanges:e=>nt((()=>{$(e[0],((e,l)=>J(e)?Lt(l):$(e,((e,t)=>J(e)?Ht(l,t):$(e,((e,n)=>ll(zt,l,t,n,e))))))),$(e[1],((e,l)=>tl(zt,l,e)))})),setTablesJson:Mt,setValuesJson:e=>{try{Ol(al(e))}catch(e){}return zt},setJson:e=>nt((()=>{try{const[l,t]=al(e);Ll(l),Ol(t)}catch(l){Mt(e)}})),setTablesSchema:Rt,setValuesSchema:St,setSchema:(e,l)=>nt((()=>{Rt(e),St(l)})),delTables:mt,delTable:Lt,delRow:Ht,delCell:(e,l,t,n)=>nt(((e,l,t)=>D(Te(se,e),(a=>D(Te(a,l),(s=>ce(s,t)?kl(e,a,l,s,t,n):0))))),e,l,t),delValues:Et,delValue:e=>nt((e=>ce(ve,e)?Nl(e):0),e),delTablesSchema:Jt,delValuesSchema:Dt,delSchema:()=>nt((()=>{Jt(),Dt()})),transaction:Ft,startTransaction:Ot,getTransactionChanges:()=>[ye(H,((e,l)=>-1===Te(M,l)?void 0:ye(e,((e,t)=>-1===Te(Te(m,l),t)?void 0:ye(e,(([,e])=>e),(e=>Ze(e)))),de,ee)),de,ee),ye(k,(([,e])=>e),(e=>Ze(e))),1],getTransactionLog:()=>[!de(H),!de(k),Re(H,Ye,Ze),Re(j),ye(k,Ye,Ze),ye(U),ye(M),Me(m),Re(L),ye(E)],finishTransaction:xt,forEachTable:e=>he(se,((l,t)=>e(t,(e=>he(l,((l,t)=>e(t,(e=>we(l,e))))))))),forEachTableCell:(e,l)=>we(Te(le,I(e)),l),forEachRow:(e,l)=>he(Te(se,I(e)),((e,t)=>l(t,(l=>we(e,l))))),forEachCell:(e,l,t)=>we(Te(Te(se,I(e)),I(l)),t),forEachValue:e=>we(ve,e),addSortedRowIdsListener:(e,l,t,n,a,s,r)=>{let o=it(e,l,t,n,a);return gl((()=>{const r=it(e,l,t,n,a);var u,i,c;i=o,A(u=r)===A(i)&&(c=(e,l)=>i[l]===e,u.every(c))||(o=r,s(zt,e,l,t,n,a,o))}),We[r?1:0],[e,l],[st])},addStartTransactionListener:e=>gl(e,il),addWillFinishTransactionListener:e=>gl(e,cl[0]),addDidFinishTransactionListener:e=>gl(e,cl[1]),callListener:e=>(Cl(e),zt),delListener:e=>(bl(e),zt),getListenerStats:()=>({hasTables:Qe(Ee),tables:Qe(Je),tableIds:Qe(De),hasTable:Qe(Fe),table:Qe(Oe),tableCellIds:Qe(xe),hasTableCell:Qe(ze,ue),rowCount:Qe(Ae),rowIds:Qe(Pe),sortedRowIds:Qe(We),hasRow:Qe(ke,ue),row:Qe(Ne,ue),cellIds:Qe(je,ue),hasCell:Qe(Ue,ie),cell:Qe(_e,ie),invalidCell:Qe(qe,ie),hasValues:Qe(el),values:Qe(nl),valueIds:Qe(rl),hasValue:Qe(ol),value:Qe(ul),invalidValue:Qe(Be),transaction:oe(il)+Qe(cl)}),isMergeable:()=>!1,createStore:vl,addListener:gl,callListeners:hl,setInternalListeners:(e,l,t,n,a)=>y=[e,l,t,n,a]};return $({[i+v]:[0,Ee,[],()=>[bt()]],[v]:[0,Je],[g]:[0,De],[i+d]:[1,Fe,[st],e=>[Ct(...e)]],[d]:[1,Oe,[st]],[d+T]:[1,xe,[st]],[i+d+f]:[2,ze,[st,rt],e=>[ft(...e)]],[b]:[1,Ae,[st]],[C]:[1,Pe,[st]],[i+h]:[2,ke,[st,ut],e=>[Tt(...e)]],[h]:[2,Ne,[st,ut]],[T]:[2,je,[st,ut]],[i+f]:[3,Ue,[st,ut,ct],e=>[wt(...e)]],[f]:[3,_e,[st,ut,ct],e=>Ke(dt(...e))],InvalidCell:[3,qe],[i+V]:[0,el,[],()=>[Vt()]],[V]:[0,nl],[p]:[0,rl],[i+w]:[1,ol,[gt],e=>[pt(...e)]],[w]:[1,ul,[gt],e=>Ke(ht(e[0]))],InvalidValue:[1,Be]},(([e,l,t,n],a)=>{zt["add"+a+u]=(...a)=>gl(a[e],l[a[e+1]?1:0],e>0?z(a,0,e):void 0,t,n)})),K(zt)};var gl=Math.pow;const hl=gl(2,36),bl=gl(2,30),Cl=gl(2,24),fl=gl(2,18),Tl=gl(2,12),wl=gl(2,6),Vl={HasTable:1,Table:1,TableCellIds:1,HasTableCell:2,RowCount:1,RowIds:1,SortedRowIds:5,HasRow:2,Row:2,CellIds:2,HasCell:3,Cell:3,HasValue:1,Value:1,InvalidCell:3,InvalidValue:1},pl=(e=l)=>[je(e),je(e)],Il=e=>{let t=1,n=pl(),a=0;const s=Ce(),r=ne(),[o,i]=(e=>{let l=0,t=-1;const n=D(e,(e=>{const l=Je(e);return ul(l/Cl)+ul(l/fl)+ul(l/Tl)+ul(l/wl)+ul(l)}),(()=>((e=16)=>k(cl(new Uint8Array(e)),((e,l)=>e+ul(l)),""))(5))),a=e=>{var n;const a=l,[s,r]=J(e)||""==e?[0,0]:[il(o=e,0)*hl+il(o,1)*bl+il(o,2)*Cl+il(o,3)*fl+il(o,4)*Tl+il(o,5)*wl+il(o,6),il(o,7)*fl+il(o,8)*Tl+il(o,9)*wl+il(o,10)];var o;l=L(a,s,null!=(n=S.HLC_TIME)?n:Date.now()),t=l==a?l==s?L(t,r):t:l==s?r:-1};return[()=>{return a(),s=++t,ul((e=l)/hl)+ul(e/bl)+ul(e/Cl)+ul(e/fl)+ul(e/Tl)+ul(e/wl)+ul(e)+ul(s/fl)+ul(s/Tl)+ul(s/wl)+ul(s)+n;var e,s},a]})(e),c=vl(),d=e=>{const l=t;return t=0,e(),t=l,C},v=(e,t=0)=>{const a={},s={},[[r,o=l,u=0],c]=e,[d,v]=n,[h,b,C]=d;let f=t?u:C,T=o;Z(r,(([e,n=l,s=0],r)=>{const o=pe(h,r,je),[u,i,c]=o;let d=t?s:c,v=n;Z(e,((e,l)=>{const[n,s,o]=g(e,pe(u,l,je),le(le(a,r,Q),l,Q),t);d^=t?0:(s?Ae(l,s):0)^Ae(l,o),v=We(v,n)})),d^=t?0:Pe(i,n),ke(o,n,d),f^=t?0:(c?Ae(r,c):0)^Ae(r,o[2]),T=We(T,v)})),f^=t?0:Pe(b,o),ke(d,o,f);const[w]=g(c,v,s,t);return i(We(T,w)),[a,s,1]},g=(e,t,n,a)=>{const[s,r=l,o=0]=e,[u,i,c]=t;let d=r,v=a?o:c;return Z(s,(([e,t,s=0],r)=>{const o=pe(u,r,(()=>[void 0,l,0])),[,i,c]=o;(!i||t>i)&&(ke(o,t,a?s:Je(sl(null!=e?e:null)+":"+t)),o[0]=e,n[r]=e,v^=a?0:Ae(r,c)^Ae(r,o[2]),d=We(d,t))})),v^=a?0:Pe(i,r),ke(t,r,v),[d,c,t[2]]},h=()=>[Ue(n[0],(e=>Ue(e,(e=>Ue(e))))),Ue(n[1])],b=e=>d((()=>c.applyChanges(v(e)))),C={getMergeableContent:h,getMergeableContentHashes:()=>[n[0][2],n[1][2]],getMergeableTableHashes:()=>ye(n[0][0],ze),getMergeableTableDiff:e=>{const l=Ne(n[0][1]),t={};return we(n[0][0],((n,[a,s,r])=>X(e,n)?r!=e[n]?t[n]=r:0:l[0][n]=_e([a,s],(e=>_e(e))))),[l,t]},getMergeableRowHashes:e=>{const l={};return Z(e,((e,t)=>D(Te(n[0][0],t),(([n,,a])=>a!=e?we(n,((e,[,,n])=>le(l,t,Q)[e]=n)):0)))),l},getMergeableRowDiff:e=>{const l=Ne(n[0][1]),t={};return Z(e,((e,a)=>{var s;return we(null==(s=Te(n[0][0],a))?void 0:s[0],((n,[s,r,o])=>X(e,n)?o!==e[n]?le(t,a,Q)[n]=o:0:le(l[0],a,Ne)[0][n]=_e([s,r])))})),[l,t]},getMergeableCellHashes:e=>{const l={};return Z(e,((e,t)=>D(Te(n[0][0],t),(([n])=>Z(e,((e,a)=>D(Te(n,a),(([n,,s])=>s!==e?we(n,((e,[,,n])=>le(le(l,t,Q),a,Q)[e]=n)):0)))))))),l},getMergeableCellDiff:e=>{const[[l,t]]=n,a={};return Z(e,((e,t)=>Z(e,((e,n)=>D(Te(l,t),(([l,s])=>D(Te(l,n),(([l,r])=>we(l,((l,[o,u,i])=>i!==e[l]?le(le(a,t,(()=>Ne(s)))[0],n,(()=>Ne(r)))[0][l]=[o,u]:0)))))))))),Oe(a,t)},getMergeableValueHashes:()=>ye(n[1][0],ze),getMergeableValueDiff:e=>{const[,[l,t]]=n,a=ye(l,De,(([,,l],t)=>l==(null==e?void 0:e[t])));return Oe(a,t)},setMergeableContent:e=>d((()=>(e=>x(e)&&2==A(e)&&qe(e[0],(e=>te(e,(e=>qe(e,(e=>te(e,(e=>qe(e,(e=>te(e,(e=>qe(e,el)),void 0,1)))),void 0,1)))),void 0,1)))&&qe(e[1],(e=>te(e,(e=>qe(e,el)),void 0,1))))(e)?c.transaction((()=>{c.delTables().delValues(),n=pl(),c.applyChanges(v(e,1))})):0)),setDefaultContent:e=>(c.transaction((()=>{a=1,c.setContent(e),a=0})),C),getTransactionMergeableChanges:(e=!1)=>{const[[l,t,a],[o,u,i]]=n,c=e?xe:Oe,d={};he(s,((e,t)=>D(Te(l,t),(([l,n,a])=>{const s={};he(e,((e,t)=>D(Te(l,t),(([l,n,a])=>{const r={};he(e,(e=>{D(Te(l,e),(([l,t,n])=>r[e]=c(l,t,n)))})),s[t]=c(r,n,a)})))),d[t]=c(s,n,a)}))));const v={};return he(r,(e=>D(Te(o,e),(([l,t,n])=>v[e]=c(l,t,n))))),[c(d,t,a),c(v,u,i),1]},applyMergeableChanges:b,merge:e=>{const l=h(),t=e.getMergeableContent();return e.applyMergeableChanges(l),b(t)}};return c.setInternalListeners((()=>{}),(()=>{}),(()=>{ge(s),ge(r)}),((e,n,r,u)=>{ae(pe(pe(s,e,Ce),n,ne),r),t&&v([[{[e]:[{[n]:[{[r]:[u,a?l:o()]}]}]}],[{}],1])}),((e,n)=>{ae(r,e),t&&v([[{}],[{[e]:[n,a?l:o()]}],1])})),$(c,((e,l)=>C[l]=y(l,"set")||y(l,"del")||y(l,"apply")||M(l,"Transaction")||l=="call"+u?(...l)=>(e(...l),C):y(l,"add")&&M(l,u)?(...t)=>{var n;const a=null!=(n=Vl[z(l,3,-8)])?n:0,s=t[a];return t[a]=(e,...l)=>s(C,...l),e(...t)}:"isMergeable"==l?()=>!0:e)),K(C)};export{Il as createMergeableStore};
