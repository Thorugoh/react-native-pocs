var e,l;e=this,l=function(e){"use strict";const l=e=>typeof e,t="",n=l(t),a=l(!0),s=l(0),r=l(l),o="type",u="default",i="Listener",c="Has",d="Ids",v="Table",g=v+"s",h=v+d,b="Row",f=b+"Count",C=b+d,T="Cell",p=T+d,w="Value",V=w+"s",y=w+d,I=e=>t+e,M=(e,l)=>e.startsWith(l),R=(e,l)=>e.endsWith(l),S=(e,l=t,n)=>e.split(l,n),m=globalThis,L=Math,H=L.max,E=L.floor,J=isFinite,D=e=>null==e,x=(e,l,t)=>D(e)?null==t?void 0:t():l(e),F=e=>e==n||e==a,O=e=>l(e)==r,z=e=>Array.isArray(e),A=(e,l,t)=>e.slice(l,t),P=e=>e.length,W=(e,l)=>e.forEach(l),j=(e,l)=>e.map(l),k=(e,l,t)=>e.reduce(l,t),N=(e,...l)=>e.push(...l),B=Object,U=e=>B.getPrototypeOf(e),_=B.entries,q=B.isFrozen,G=e=>!D(e)&&x(U(e),(e=>e==B.prototype||D(U(e))),(()=>!0)),K=B.keys,Q=B.freeze,X=(e=[])=>B.fromEntries(e),Y=(e,l)=>l in e,Z=(e,l)=>(delete e[l],e),$=(e,l)=>W(_(e),(([e,t])=>l(t,e))),ee=(e,l)=>X(((e,l)=>j(_(e),(([e,t])=>l(t,e))))(e,((e,t)=>[t,l(e,t)]))),le=e=>G(e)&&0==(e=>P(K(e)))(e),te=(e,l,t)=>(Y(e,l)||(e[l]=t()),e[l]),ne=(e,l,t,n=0)=>D(e)||!G(e)||!n&&le(e)||q(e)?(null==t||t(),!1):($(e,((t,n)=>{l(t,n)||Z(e,n)})),!!n||!le(e)),ae=e=>new Set(z(e)||D(e)?e:[e]),se=(e,l)=>null==e?void 0:e.add(l),re=e=>l=>k(ge(l),((l,t)=>l+e(t)),0),oe=e=>{var l;return null!=(l=null==e?void 0:e.size)?l:0},ue=re(oe),ie=re(ue),ce=re(ie),de=(e,l)=>{var t;return null!=(t=null==e?void 0:e.has(l))&&t},ve=e=>D(e)||0==oe(e),ge=e=>{var l;return[...null!=(l=null==e?void 0:e.values())?l:[]]},he=e=>e.clear(),be=(e,l)=>null==e?void 0:e.forEach(l),fe=(e,l)=>null==e?void 0:e.delete(l),Ce=e=>new Map(e),Te=e=>{var l;return[...null!=(l=null==e?void 0:e.keys())?l:[]]},pe=(e,l)=>null==e?void 0:e.get(l),we=(e,l)=>be(e,((e,t)=>l(t,e))),Ve=(e,l,t)=>D(t)?(fe(e,l),e):null==e?void 0:e.set(l,t),ye=(e,l,t,n)=>(de(e,l)?null==n||n(pe(e,l)):Ve(e,l,t()),pe(e,l)),Ie=(e,l,t,n=Ve)=>(ee(l,((l,n)=>t(e,n,l))),we(e,(t=>Y(l,t)?0:n(e,t))),e),Me=(e,l,t,n)=>{const a={};return be(e,((e,s)=>{if(!(null==t?void 0:t(e,s))){const t=l?l(e,s):e;(null==n?void 0:n(t))||(a[s]=t)}})),a},Re=(e,l,t)=>Me(e,(e=>Me(e,l,t)),ve,le),Se=(e,l,t)=>Me(e,(e=>Re(e,l,t)),ve,le),me=(e,l)=>{const t=Ce();return be(e,((e,n)=>{var a;return t.set(n,null!=(a=null==l?void 0:l(e))?a:e)})),t},Le=e=>me(e,me),He=e=>me(e,Le),Ee=(e,l,t,n,a=0)=>x((t?ye:pe)(e,l[a],a>P(l)-2?t:Ce),(s=>{if(a>P(l)-2)return(null==n?void 0:n(s))&&Ve(e,l[a]),s;const r=Ee(s,l,t,n,a+1);return ve(s)&&Ve(e,l[a]),r})),Je=new m.TextEncoder,De=e=>{let l=2166136261;return W(Je.encode(e),(e=>{l^=e,l+=(l<<1)+(l<<4)+(l<<7)+(l<<8)+(l<<24)})),l>>>0},xe=([e,l])=>Oe(e,l),Fe=([e,l,t])=>[e,l,t],Oe=(e,l)=>l?[e,l]:[e],ze=(e,l,t)=>[e,l,t],Ae=e=>e[2],Pe=(e,l)=>De(e+":"+l),We=(e,l)=>l>e?(e?De(e):0)^De(l):0,je=(e,l)=>{var t;return null!=(t=(null!=e?e:"")>(null!=l?l:"")?e:l)?t:""},ke=(e,l,t)=>{l>e[1]&&(e[1]=l),e[2]=t>>>0},Ne=(e=t)=>Oe(X(),e),Be=(e=t)=>[Ce(),e,0],Ue=([e,l,t],n=Fe)=>[Me(e,n),l,t],_e=([e,l],t=xe)=>Oe(Me(e,t),l),qe=(e,t)=>{return z(e)&&3==P(e)&&(a=e[1],l(a)==n)&&l(e[2])==s&&J(e[2])&&t(e[0]);var a},Ge=/^\d+$/,Ke=()=>{const e=[];let l=0;return[n=>{var a;return null!=(a=n?e.shift():null)?a:t+l++},l=>{Ge.test(l)&&P(e)<1e3&&N(e,l)}]},Qe=e=>[e,e],Xe=(e,l=ue)=>l(e[0])+l(e[1]),Ye=()=>[Ce(),Ce()],Ze=e=>[...e],$e=([e,l])=>e===l,el=e=>{const t=l(e);return F(t)||t==s&&J(e)?t:void 0},ll=e=>D(e)||!D(el(e)),tl=(e,l,t,n,a)=>D(a)?e.delCell(l,t,n,!0):e.setCell(l,t,n,a),nl=(e,l,t)=>D(t)?e.delValue(l):e.setValue(l,t),al=JSON.stringify,sl=JSON.parse,rl=e=>al(e,((e,l)=>l instanceof Map?B.fromEntries([...l]):l)),ol=S("-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz"),ul=Ce(j(ol,((e,l)=>[e,l]))),il=e=>ol[63&e],cl=(e,l)=>{var t;return null!=(t=pe(ul,e[l]))?t:0},dl=m.crypto?e=>m.crypto.getRandomValues(e):e=>j(e,(()=>E(256*L.random()))),vl=(e,l,t)=>Ve(e,l,pe(e,l)==-t?void 0:t),gl=()=>{let e,l,n=!1,a=!1,r=0,d=[];const M=Ce(),R=Ce(),S=Ce(),m=Ce(),L=Ce(),H=Ce(),E=Ce(),J=Ce(),k=Ce(),B=Ce(),U=Ce(),_=Ce(),q=Ce(),G=Ce(),K=ae(),X=Ce(),$=Ce(),te=Ce(),re=Ce(),ge=Ye(),Je=Ye(),De=Ye(),xe=Ye(),Fe=Ye(),Oe=Ye(),ze=Ye(),Ae=Ye(),Pe=Ye(),We=Ye(),je=Ye(),ke=Ye(),Ne=Ye(),Be=Ye(),Ue=Ye(),_e=Ye(),qe=Ye(),Ge=Ye(),ll=Ye(),al=Ye(),ol=Ye(),ul=Ye(),il=Ce(),cl=Ye(),[dl,hl,bl,fl]=(()=>{let e;const[l,n]=Ke(),a=Ce();return[(n,s,r,o=[],u=()=>[])=>{null!=e||(e=zt);const i=l(1);return Ve(a,i,[n,s,r,o,u]),se(Ee(s,null!=r?r:[t],ae),i),i},(l,n,...s)=>W(((e,l=[t])=>{const n=[],a=(e,t)=>t==P(l)?N(n,e):null===l[t]?be(e,(e=>a(e,t+1))):W([l[t],null],(l=>a(pe(e,l),t+1)));return a(e,0),n})(l,n),(l=>be(l,(l=>pe(a,l)[0](e,...null!=n?n:[],...s))))),e=>x(pe(a,e),(([,l,s])=>(Ee(l,null!=s?s:[t],void 0,(l=>(fe(l,e),ve(l)?1:0))),Ve(a,e),n(e),s))),l=>x(pe(a,l),(([l,,t=[],n,a])=>{const s=(...r)=>{var o,u;const i=P(r);i==P(t)?l(e,...r,...a(r)):D(t[i])?W(null!=(u=null==(o=n[i])?void 0:o.call(n,...r))?u:[],(e=>s(...r,e))):s(...r,t[i])};s()}))]})(),Cl=e=>{if(!ne(e,((e,l)=>[o,u].includes(l))))return!1;const l=e[o];return!(!F(l)&&l!=s||(el(e[u])!=l&&Z(e,u),0))},Tl=z,pl=(l,t)=>(!e||de(U,t)||Kl(t))&&ne(l,((e,l)=>wl(t,l,e)),(()=>Kl(t))),wl=(e,l,t,n)=>ne(n?t:Ml(t,e,l),((n,a)=>x(Vl(e,l,a,n),(e=>(t[a]=e,!0)),(()=>!1))),(()=>Kl(e,l))),Vl=(l,t,n,a)=>e?x(pe(pe(U,l),n),(e=>el(a)!=e[o]?Kl(l,t,n,a,e[u]):a),(()=>Kl(l,t,n,a))):D(el(a))?Kl(l,t,n,a):a,yl=(e,l)=>ne(l?e:Rl(e),((l,t)=>x(Il(t,l),(l=>(e[t]=l,!0)),(()=>!1))),(()=>Ql())),Il=(e,t)=>l?x(pe(q,e),(l=>el(t)!=l[o]?Ql(e,t,l[u]):t),(()=>Ql(e,t))):D(el(t))?Ql(e,t):t,Ml=(e,l,t)=>(x(pe(_,l),(([n,a])=>{be(n,((l,t)=>{Y(e,t)||(e[t]=l)})),be(a,(n=>{Y(e,n)||Kl(l,t,n)}))})),e),Rl=e=>(l&&(be(G,((l,t)=>{Y(e,t)||(e[t]=l)})),be(K,(l=>{Y(e,l)||Ql(l)}))),e),Sl=e=>Ie(U,e,((e,l,t)=>{const n=Ce(),a=ae();Ie(ye(U,l,Ce),t,((e,l,t)=>{Ve(e,l,t),x(t[u],(e=>Ve(n,l,e)),(()=>se(a,l)))})),Ve(_,l,[n,a])}),((e,l)=>{Ve(U,l),Ve(_,l)})),ml=e=>Ie(q,e,((e,l,t)=>{Ve(q,l,t),x(t[u],(e=>Ve(G,l,e)),(()=>se(K,l)))}),((e,l)=>{Ve(q,l),Ve(G,l),fe(K,l)})),Ll=e=>le(e)?mt():yt(e),Hl=e=>Ie(te,e,((e,l,t)=>El(l,t)),((e,l)=>Pl(l))),El=(e,l)=>Ie(ye(te,e,(()=>(Nl(e,1),Ve(X,e,Ke()),Ve($,e,Ce()),Ce()))),l,((l,t,n)=>Jl(e,l,t,n)),((l,t)=>Wl(e,l,t))),Jl=(e,l,t,n,a)=>Ie(ye(l,t,(()=>(Bl(e,t,1),Ce()))),n,((l,n,a)=>Dl(e,t,l,n,a)),((n,s)=>jl(e,l,t,n,s,a))),Dl=(e,l,t,n,a)=>{de(t,n)||Ul(e,l,n,1);const s=pe(t,n);a!==s&&(_l(e,l,n,s,a),Ve(t,n,a))},xl=(e,l,t,n,a)=>x(pe(l,t),(l=>Dl(e,t,l,n,a)),(()=>Jl(e,l,t,Ml({[n]:a},e,t)))),Fl=e=>le(e)?Et():It(e),Ol=e=>Ie(re,e,((e,l,t)=>zl(l,t)),((e,l)=>kl(l))),zl=(e,l)=>{de(re,e)||ql(e,1);const t=pe(re,e);l!==t&&(Gl(e,t,l),Ve(re,e,l))},Al=e=>{var l;return null!=(l=pe(te,e))?l:El(e,{})},Pl=e=>El(e,{}),Wl=(e,l,t)=>{const[,n]=pe(X,e);n(t),Jl(e,l,t,{},!0)},jl=(e,l,t,n,a,s)=>{var r;const o=pe(null==(r=pe(_,e))?void 0:r[0],a);if(!D(o)&&!s)return Dl(e,t,n,a,o);const u=l=>{_l(e,t,l,pe(n,l)),Ul(e,t,l,-1),Ve(n,l)};D(o)?u(a):we(n,u),ve(n)&&(Bl(e,t,-1),ve(Ve(l,t))&&(Nl(e,-1),Ve(te,e),Ve(X,e),Ve($,e)))},kl=e=>{const l=pe(G,e);if(!D(l))return zl(e,l);Gl(e,pe(re,e)),ql(e,-1),Ve(re,e)},Nl=(e,l)=>vl(M,e,l),Bl=(e,l,t)=>vl(ye(m,e,Ce),l,t)&&Ve(S,e,ye(S,e,(()=>0))+t),Ul=(e,l,t,n)=>{var a;const s=pe($,e),r=null!=(a=pe(s,t))?a:0;(0==r&&1==n||1==r&&-1==n)&&vl(ye(R,e,Ce),t,n),Ve(s,t,r!=-n?r+n:null),vl(ye(ye(L,e,Ce),l,Ce),t,n)},_l=(e,l,t,n,a)=>{var s;ye(ye(ye(H,e,Ce),l,Ce),t,(()=>[n,0]))[1]=a,null==(s=d[3])||s.call(d,e,l,t,a)},ql=(e,l)=>vl(E,e,l),Gl=(e,l,t)=>{var n;ye(J,e,(()=>[l,0]))[1]=t,null==(n=d[4])||n.call(d,e,t)},Kl=(e,l,t,n,a)=>(N(ye(ye(ye(k,e,Ce),l,Ce),t,(()=>[])),n),a),Ql=(e,l,t)=>(N(ye(B,e,(()=>[])),l),t),Xl=(e,l,t)=>x(pe(pe(pe(H,e),l),t),(([e,l])=>[!0,e,l]),(()=>[!1,...Qe(dt(e,l,t))])),Yl=e=>x(pe(J,e),(([e,l])=>[!0,e,l]),(()=>[!1,...Qe(ht(e))])),Zl=e=>ve(k)||ve(_e[e])?0:be(e?He(k):k,((l,t)=>be(l,((l,n)=>be(l,((l,a)=>hl(_e[e],[t,n,a],l))))))),$l=e=>ve(B)||ve(qe[e])?0:be(e?me(B):B,((l,t)=>hl(qe[e],[t],l))),et=(e,l,t,n)=>{if(!ve(e))return hl(l,n,(()=>Me(e))),we(e,((e,l)=>hl(t,[...null!=n?n:[],e],1==l))),1},lt=e=>{const l=bt();l!=n&&hl(ge[e],void 0,l);const t=ve(We[e]),a=ve(Ne[e])&&ve(Be[e])&&ve(Pe[e])&&ve(je[e])&&ve(Oe[e])&&ve(ze[e])&&ve(Ae[e])&&t&&ve(De[e])&&ve(xe[e]),s=ve(Ue[e])&&ve(ke[e])&&ve(Fe[e])&&ve(Je[e]);if(!a||!s){const l=e?[me(M),Le(R),me(S),Le(m),He(L),He(H)]:[M,R,S,m,L,H];if(!a){et(l[0],De[e],xe[e]),be(l[1],((l,t)=>et(l,Oe[e],ze[e],[t]))),be(l[2],((l,t)=>{0!=l&&hl(Ae[e],[t],ot(t))}));const n=ae();be(l[3],((l,a)=>{et(l,Pe[e],je[e],[a])&&!t&&(hl(We[e],[a,null]),se(n,a))})),t||be(l[5],((l,t)=>{if(!de(n,t)){const n=ae();be(l,(e=>be(e,(([l,t],a)=>t!==l?se(n,a):fe(e,a))))),be(n,(l=>hl(We[e],[t,l])))}})),be(l[4],((l,t)=>be(l,((l,n)=>et(l,Ne[e],Be[e],[t,n])))))}if(!s){let t;be(l[5],((l,n)=>{let a;be(l,((l,s)=>{let r;be(l,(([l,o],u)=>{o!==l&&(hl(Ue[e],[n,s,u],o,l,Xl),t=a=r=1)})),r&&hl(ke[e],[n,s],Xl)})),a&&hl(Fe[e],[n],Xl)})),t&&hl(Je[e],void 0,Xl)}}},tt=e=>{const l=wt();l!=a&&hl(Ge[e],void 0,l);const t=ve(al[e])&&ve(ol[e]),n=ve(ul[e])&&ve(ll[e]);if(!t||!n){const l=e?[me(E),me(J)]:[E,J];if(t||et(l[0],al[e],ol[e]),!n){let t;be(l[1],(([l,n],a)=>{n!==l&&(hl(ul[e],[a],n,l,Yl),t=1)})),t&&hl(ll[e],void 0,Yl)}}},nt=(e,...l)=>(xt((()=>e(...j(l,I)))),zt),at=()=>Se(te),st=()=>Te(te),rt=e=>Te(pe($,I(e))),ot=e=>oe(pe(te,I(e))),ut=e=>Te(pe(te,I(e))),it=(e,l,t,n=0,a)=>{return j(A((r=pe(te,I(e)),o=(e,t)=>[D(l)?t:pe(e,I(l)),t],s=([e],[l])=>{return((null!=(n=e)?n:0)<(null!=(a=l)?a:0)?-1:1)*(t?-1:1);var n,a},j([...null!=(u=null==r?void 0:r.entries())?u:[]],(([e,l])=>o(l,e))).sort(s)),n,D(a)?a:n+a),(([,e])=>e));var s,r,o,u},ct=(e,l)=>Te(pe(pe(te,I(e)),I(l))),dt=(e,l,t)=>pe(pe(pe(te,I(e)),I(l)),I(t)),vt=()=>Me(re),gt=()=>Te(re),ht=e=>pe(re,I(e)),bt=()=>!ve(te),ft=e=>de(te,I(e)),Ct=(e,l)=>de(pe($,I(e)),I(l)),Tt=(e,l)=>de(pe(te,I(e)),I(l)),pt=(e,l,t)=>de(pe(pe(te,I(e)),I(l)),I(t)),wt=()=>!ve(re),Vt=e=>de(re,I(e)),yt=e=>nt((()=>(e=>ne(e,pl,Kl))(e)?Hl(e):0)),It=e=>nt((()=>yl(e)?Ol(e):0)),Mt=e=>{try{Ll(sl(e))}catch(e){}return zt},Rt=l=>nt((()=>{if((e=ne(l,(e=>ne(e,Cl))))&&(Sl(l),!ve(te))){const e=at();mt(),yt(e)}})),St=e=>nt((()=>{if(l=(e=>ne(e,Cl))(e)){const t=vt();Dt(),Et(),l=!0,ml(e),It(t)}})),mt=()=>nt((()=>Hl({}))),Lt=e=>nt((e=>de(te,e)?Pl(e):0),e),Ht=(e,l)=>nt(((e,l)=>x(pe(te,e),(t=>de(t,l)?Wl(e,t,l):0))),e,l),Et=()=>nt((()=>Ol({}))),Jt=()=>nt((()=>{Sl({}),e=!1})),Dt=()=>nt((()=>{ml({}),l=!1})),xt=(e,l)=>{if(-1!=r){Ft();const t=e();return Ot(l),t}},Ft=()=>{var e;return-1!=r&&r++,1==r&&(null==(e=d[0])||e.call(d),hl(il)),zt},Ot=e=>{var l,t;return r>0&&(r--,0==r&&(r=1,Zl(1),ve(H)||lt(1),$l(1),ve(J)||tt(1),(null==e?void 0:e(zt))&&(be(H,((e,l)=>be(e,((e,t)=>be(e,(([e],n)=>tl(zt,l,t,n,e))))))),he(H),be(J,(([e],l)=>nl(zt,l,e))),he(J)),hl(cl[0],void 0),r=-1,Zl(0),ve(H)||lt(0),$l(0),ve(J)||tt(0),null==(l=d[1])||l.call(d),hl(cl[1],void 0),null==(t=d[2])||t.call(d),r=0,n=bt(),a=wt(),W([M,R,S,m,L,H,k,E,J,B],he))),zt},zt={getContent:()=>[at(),vt()],getTables:at,getTableIds:st,getTable:e=>Re(pe(te,I(e))),getTableCellIds:rt,getRowCount:ot,getRowIds:ut,getSortedRowIds:it,getRow:(e,l)=>Me(pe(pe(te,I(e)),I(l))),getCellIds:ct,getCell:dt,getValues:vt,getValueIds:gt,getValue:ht,hasTables:bt,hasTable:ft,hasTableCell:Ct,hasRow:Tt,hasCell:pt,hasValues:wt,hasValue:Vt,getTablesJson:()=>rl(te),getValuesJson:()=>rl(re),getJson:()=>rl([te,re]),getTablesSchemaJson:()=>rl(U),getValuesSchemaJson:()=>rl(q),getSchemaJson:()=>rl([U,q]),hasTablesSchema:()=>e,hasValuesSchema:()=>l,setContent:e=>nt((()=>{const l=O(e)?e():e;Tl(l)&&(([e,l])=>{(le(e)?mt:yt)(e),(le(l)?Et:It)(l)})(l)})),setTables:yt,setTable:(e,l)=>nt((e=>pl(l,e)?El(e,l):0),e),setRow:(e,l,t)=>nt(((e,l)=>wl(e,l,t)?Jl(e,Al(e),l,t):0),e,l),addRow:(e,l,t=!0)=>xt((()=>{let n;return wl(e,n,l)&&(e=I(e),Jl(e,Al(e),n=((e,l)=>{const[t]=pe(X,e);let n;do{n=t(l)}while(de(pe(te,e),n));return n})(e,t?1:0),l)),n})),setPartialRow:(e,l,t)=>nt(((e,l)=>{if(wl(e,l,t,1)){const n=Al(e);ee(t,((t,a)=>xl(e,n,l,a,t)))}}),e,l),setCell:(e,l,t,n)=>nt(((e,l,t)=>x(Vl(e,l,t,O(n)?n(dt(e,l,t)):n),(n=>xl(e,Al(e),l,t,n)))),e,l,t),setValues:It,setPartialValues:e=>nt((()=>yl(e,1)?ee(e,((e,l)=>zl(l,e))):0)),setValue:(e,l)=>nt((e=>x(Il(e,O(l)?l(ht(e)):l),(l=>zl(e,l)))),e),applyChanges:e=>nt((()=>{ee(e[0],((e,l)=>D(e)?Lt(l):ee(e,((e,t)=>D(e)?Ht(l,t):ee(e,((e,n)=>tl(zt,l,t,n,e))))))),ee(e[1],((e,l)=>nl(zt,l,e)))})),setTablesJson:Mt,setValuesJson:e=>{try{Fl(sl(e))}catch(e){}return zt},setJson:e=>nt((()=>{try{const[l,t]=sl(e);Ll(l),Fl(t)}catch(l){Mt(e)}})),setTablesSchema:Rt,setValuesSchema:St,setSchema:(e,l)=>nt((()=>{Rt(e),St(l)})),delTables:mt,delTable:Lt,delRow:Ht,delCell:(e,l,t,n)=>nt(((e,l,t)=>x(pe(te,e),(a=>x(pe(a,l),(s=>de(s,t)?jl(e,a,l,s,t,n):0))))),e,l,t),delValues:Et,delValue:e=>nt((e=>de(re,e)?kl(e):0),e),delTablesSchema:Jt,delValuesSchema:Dt,delSchema:()=>nt((()=>{Jt(),Dt()})),transaction:xt,startTransaction:Ft,getTransactionChanges:()=>[Me(H,((e,l)=>-1===pe(M,l)?void 0:Me(e,((e,t)=>-1===pe(pe(m,l),t)?void 0:Me(e,(([,e])=>e),(e=>$e(e)))),ve,le)),ve,le),Me(J,(([,e])=>e),(e=>$e(e))),1],getTransactionLog:()=>[!ve(H),!ve(J),Se(H,Ze,$e),Se(k),Me(J,Ze,$e),Me(B),Me(M),Re(m),Se(L),Me(E)],finishTransaction:Ot,forEachTable:e=>be(te,((l,t)=>e(t,(e=>be(l,((l,t)=>e(t,(e=>we(l,e))))))))),forEachTableCell:(e,l)=>we(pe($,I(e)),l),forEachRow:(e,l)=>be(pe(te,I(e)),((e,t)=>l(t,(l=>we(e,l))))),forEachCell:(e,l,t)=>we(pe(pe(te,I(e)),I(l)),t),forEachValue:e=>we(re,e),addSortedRowIdsListener:(e,l,t,n,a,s,r)=>{let o=it(e,l,t,n,a);return dl((()=>{const r=it(e,l,t,n,a);var u,i,c;i=o,P(u=r)===P(i)&&(c=(e,l)=>i[l]===e,u.every(c))||(o=r,s(zt,e,l,t,n,a,o))}),We[r?1:0],[e,l],[st])},addStartTransactionListener:e=>dl(e,il),addWillFinishTransactionListener:e=>dl(e,cl[0]),addDidFinishTransactionListener:e=>dl(e,cl[1]),callListener:e=>(fl(e),zt),delListener:e=>(bl(e),zt),getListenerStats:()=>({hasTables:Xe(ge),tables:Xe(Je),tableIds:Xe(De),hasTable:Xe(xe),table:Xe(Fe),tableCellIds:Xe(Oe),hasTableCell:Xe(ze,ie),rowCount:Xe(Ae),rowIds:Xe(Pe),sortedRowIds:Xe(We),hasRow:Xe(je,ie),row:Xe(ke,ie),cellIds:Xe(Ne,ie),hasCell:Xe(Be,ce),cell:Xe(Ue,ce),invalidCell:Xe(_e,ce),hasValues:Xe(Ge),values:Xe(ll),valueIds:Xe(al),hasValue:Xe(ol),value:Xe(ul),invalidValue:Xe(qe),transaction:ue(il)+Xe(cl)}),isMergeable:()=>!1,createStore:gl,addListener:dl,callListeners:hl,setInternalListeners:(e,l,t,n,a)=>d=[e,l,t,n,a]};return ee({[c+g]:[0,ge,[],()=>[bt()]],[g]:[0,Je],[h]:[0,De],[c+v]:[1,xe,[st],e=>[ft(...e)]],[v]:[1,Fe,[st]],[v+p]:[1,Oe,[st]],[c+v+T]:[2,ze,[st,rt],e=>[Ct(...e)]],[f]:[1,Ae,[st]],[C]:[1,Pe,[st]],[c+b]:[2,je,[st,ut],e=>[Tt(...e)]],[b]:[2,ke,[st,ut]],[p]:[2,Ne,[st,ut]],[c+T]:[3,Be,[st,ut,ct],e=>[pt(...e)]],[T]:[3,Ue,[st,ut,ct],e=>Qe(dt(...e))],InvalidCell:[3,_e],[c+V]:[0,Ge,[],()=>[wt()]],[V]:[0,ll],[y]:[0,al],[c+w]:[1,ol,[gt],e=>[Vt(...e)]],[w]:[1,ul,[gt],e=>Qe(ht(e[0]))],InvalidValue:[1,qe]},(([e,l,t,n],a)=>{zt["add"+a+i]=(...a)=>dl(a[e],l[a[e+1]?1:0],e>0?A(a,0,e):void 0,t,n)})),Q(zt)};var hl=Math.pow;const bl=hl(2,36),fl=hl(2,30),Cl=hl(2,24),Tl=hl(2,18),pl=hl(2,12),wl=hl(2,6),Vl={HasTable:1,Table:1,TableCellIds:1,HasTableCell:2,RowCount:1,RowIds:1,SortedRowIds:5,HasRow:2,Row:2,CellIds:2,HasCell:3,Cell:3,HasValue:1,Value:1,InvalidCell:3,InvalidValue:1},yl=(e=t)=>[Be(e),Be(e)];e.createMergeableStore=e=>{let l=1,n=yl(),a=0;const s=Ce(),r=ae(),[o,u]=(e=>{let l=0,t=-1;const n=x(e,(e=>{const l=De(e);return il(l/Cl)+il(l/Tl)+il(l/pl)+il(l/wl)+il(l)}),(()=>((e=16)=>k(dl(new Uint8Array(e)),((e,l)=>e+il(l)),""))(5))),a=e=>{var n;const a=l,[s,r]=D(e)||""==e?[0,0]:[cl(o=e,0)*bl+cl(o,1)*fl+cl(o,2)*Cl+cl(o,3)*Tl+cl(o,4)*pl+cl(o,5)*wl+cl(o,6),cl(o,7)*Tl+cl(o,8)*pl+cl(o,9)*wl+cl(o,10)];var o;l=H(a,s,null!=(n=m.HLC_TIME)?n:Date.now()),t=l==a?l==s?H(t,r):t:l==s?r:-1};return[()=>{return a(),s=++t,il((e=l)/bl)+il(e/fl)+il(e/Cl)+il(e/Tl)+il(e/pl)+il(e/wl)+il(e)+il(s/Tl)+il(s/pl)+il(s/wl)+il(s)+n;var e,s},a]})(e),c=gl(),d=e=>{const t=l;return l=0,e(),l=t,f},v=(e,l=0)=>{const a={},s={},[[r,o=t,i=0],c]=e,[d,v]=n,[h,b,f]=d;let C=l?i:f,T=o;$(r,(([e,n=t,s=0],r)=>{const o=ye(h,r,Be),[u,i,c]=o;let d=l?s:c,v=n;$(e,((e,t)=>{const[n,s,o]=g(e,ye(u,t,Be),te(te(a,r,X),t,X),l);d^=l?0:(s?Pe(t,s):0)^Pe(t,o),v=je(v,n)})),d^=l?0:We(i,n),ke(o,n,d),C^=l?0:(c?Pe(r,c):0)^Pe(r,o[2]),T=je(T,v)})),C^=l?0:We(b,o),ke(d,o,C);const[p]=g(c,v,s,l);return u(je(T,p)),[a,s,1]},g=(e,l,n,a)=>{const[s,r=t,o=0]=e,[u,i,c]=l;let d=r,v=a?o:c;return $(s,(([e,l,s=0],r)=>{const o=ye(u,r,(()=>[void 0,t,0])),[,i,c]=o;(!i||l>i)&&(ke(o,l,a?s:De(rl(null!=e?e:null)+":"+l)),o[0]=e,n[r]=e,v^=a?0:Pe(r,c)^Pe(r,o[2]),d=je(d,l))})),v^=a?0:We(i,r),ke(l,r,v),[d,c,l[2]]},h=()=>[Ue(n[0],(e=>Ue(e,(e=>Ue(e))))),Ue(n[1])],b=e=>d((()=>c.applyChanges(v(e)))),f={getMergeableContent:h,getMergeableContentHashes:()=>[n[0][2],n[1][2]],getMergeableTableHashes:()=>Me(n[0][0],Ae),getMergeableTableDiff:e=>{const l=Ne(n[0][1]),t={};return we(n[0][0],((n,[a,s,r])=>Y(e,n)?r!=e[n]?t[n]=r:0:l[0][n]=_e([a,s],(e=>_e(e))))),[l,t]},getMergeableRowHashes:e=>{const l={};return $(e,((e,t)=>x(pe(n[0][0],t),(([n,,a])=>a!=e?we(n,((e,[,,n])=>te(l,t,X)[e]=n)):0)))),l},getMergeableRowDiff:e=>{const l=Ne(n[0][1]),t={};return $(e,((e,a)=>{var s;return we(null==(s=pe(n[0][0],a))?void 0:s[0],((n,[s,r,o])=>Y(e,n)?o!==e[n]?te(t,a,X)[n]=o:0:te(l[0],a,Ne)[0][n]=_e([s,r])))})),[l,t]},getMergeableCellHashes:e=>{const l={};return $(e,((e,t)=>x(pe(n[0][0],t),(([n])=>$(e,((e,a)=>x(pe(n,a),(([n,,s])=>s!==e?we(n,((e,[,,n])=>te(te(l,t,X),a,X)[e]=n)):0)))))))),l},getMergeableCellDiff:e=>{const[[l,t]]=n,a={};return $(e,((e,t)=>$(e,((e,n)=>x(pe(l,t),(([l,s])=>x(pe(l,n),(([l,r])=>we(l,((l,[o,u,i])=>i!==e[l]?te(te(a,t,(()=>Ne(s)))[0],n,(()=>Ne(r)))[0][l]=[o,u]:0)))))))))),Oe(a,t)},getMergeableValueHashes:()=>Me(n[1][0],Ae),getMergeableValueDiff:e=>{const[,[l,t]]=n,a=Me(l,xe,(([,,l],t)=>l==(null==e?void 0:e[t])));return Oe(a,t)},setMergeableContent:e=>d((()=>(e=>z(e)&&2==P(e)&&qe(e[0],(e=>ne(e,(e=>qe(e,(e=>ne(e,(e=>qe(e,(e=>ne(e,(e=>qe(e,ll)),void 0,1)))),void 0,1)))),void 0,1)))&&qe(e[1],(e=>ne(e,(e=>qe(e,ll)),void 0,1))))(e)?c.transaction((()=>{c.delTables().delValues(),n=yl(),c.applyChanges(v(e,1))})):0)),setDefaultContent:e=>(c.transaction((()=>{a=1,c.setContent(e),a=0})),f),getTransactionMergeableChanges:(e=!1)=>{const[[l,t,a],[o,u,i]]=n,c=e?ze:Oe,d={};be(s,((e,t)=>x(pe(l,t),(([l,n,a])=>{const s={};be(e,((e,t)=>x(pe(l,t),(([l,n,a])=>{const r={};be(e,(e=>{x(pe(l,e),(([l,t,n])=>r[e]=c(l,t,n)))})),s[t]=c(r,n,a)})))),d[t]=c(s,n,a)}))));const v={};return be(r,(e=>x(pe(o,e),(([l,t,n])=>v[e]=c(l,t,n))))),[c(d,t,a),c(v,u,i),1]},applyMergeableChanges:b,merge:e=>{const l=h(),t=e.getMergeableContent();return e.applyMergeableChanges(l),b(t)}};return c.setInternalListeners((()=>{}),(()=>{}),(()=>{he(s),he(r)}),((e,n,r,u)=>{se(ye(ye(s,e,Ce),n,ae),r),l&&v([[{[e]:[{[n]:[{[r]:[u,a?t:o()]}]}]}],[{}],1])}),((e,n)=>{se(r,e),l&&v([[{}],[{[e]:[n,a?t:o()]}],1])})),ee(c,((e,l)=>f[l]=M(l,"set")||M(l,"del")||M(l,"apply")||R(l,"Transaction")||l=="call"+i?(...l)=>(e(...l),f):M(l,"add")&&R(l,i)?(...t)=>{var n;const a=null!=(n=Vl[A(l,3,-8)])?n:0,s=t[a];return t[a]=(e,...l)=>s(f,...l),e(...t)}:"isMergeable"==l?()=>!0:e)),Q(f)}},"object"==typeof exports&&"undefined"!=typeof module?l(exports):"function"==typeof define&&define.amd?define(["exports"],l):l((e="undefined"!=typeof globalThis?globalThis:e||self).TinyBaseMergeableStore={});
