var e,l;e=this,l=function(e,l,t){"use strict";const s=e=>typeof e,a=s(""),n=s(!0),o=s(0),u="Value",r="currentTarget",d="value",i=Math.min,c=isFinite,m=e=>null==e,b=(e,l,t,s)=>e==a?l:e==o?t:s,{PureComponent:h,Fragment:I,createContext:C,createElement:p,useCallback:y,useContext:g,useEffect:T,useLayoutEffect:w,useMemo:R,useRef:f,useState:k,useSyncExternalStore:S}=t,N=(e,...l)=>m(e)?{}:e(...l),V=(e,l)=>e.map(l),v=Object,x=v.entries,q=(e=[])=>v.fromEntries(e),E=(e,l)=>V(x(e),(([e,t])=>l(t,e))),H="editable",O=(e,t)=>V(l.useTableCellIds(e,t),(l=>e+"."+l)),B=(e,l,t)=>{const s=y(e,l);return t?s:void 0},P=(...e)=>R((()=>e),e),j=(e,l)=>R((()=>({store:e,tableId:l})),[e,l]),A=(e,l)=>R((()=>({queries:e,queryId:l})),[e,l]),F=(e,l=!1,t,s=0,a,n,o,u)=>{const[[r,d,i],c]=k([e,l,s]),m=y((e=>{c(e),u?.(e)}),[u]),b=B((e=>m([e,e==r&&!d,i])),[m,r,d,i],t),h=y((e=>m([r,d,e])),[m,r,d]),I=!0===o?J:o;return[[r,d,i],b,R((()=>!1===o?null:p(I,{offset:i,limit:a,total:n,onChange:h})),[o,I,i,a,n,h])]},L=(e,l,t)=>R((()=>{const n=l??e;return o=Array.isArray(n)?q(V(n,(e=>[e,e]))):n,u=(e,l)=>{return{label:l,component:t,...(n=e,s(n)==a?{label:e}:e)};var n},q(E(o,((e,l)=>[l,u(e,l)])));var o,u}),[l,t,e]),M=({className:e,headerRow:l,idColumn:t,params:[s,a,n,o,u,r]})=>p("table",{className:e},r?p("caption",null,r):null,!1===l?null:p("thead",null,p("tr",null,!1===t?null:p(U,{sort:o??[],label:"Id",onClick:u}),E(s,(({label:e},l)=>p(U,{key:l,cellId:l,label:e,sort:o??[],onClick:u}))))),p("tbody",null,V(n,(e=>p("tr",{key:e},!1===t?null:p("th",null,e),E(s,(({component:l,getComponentProps:t},s)=>p("td",{key:s},p(l,{...N(t,e,s),...a,rowId:e,cellId:s}))))))))),U=({cellId:e,sort:[l,t],label:s=e??"",onClick:a})=>p("th",{onClick:B((()=>a?.(e)),[a,e],a),className:m(t)||l!=e?void 0:`sorted ${t?"de":"a"}scending`},m(t)||l!=e?null:(t?"↓":"↑")+" ",s),D=({localRowId:e,params:[t,s,a,n,o,u,r]})=>{const d=l.useRemoteRowId(o,e,u);return p("tr",null,!1===t?null:p(I,null,p("th",null,e),p("th",null,d)),E(s,(({component:l,getComponentProps:t},s)=>{const[o,u]=((e,l="",t)=>e.split(l,t))(s,".",2),i=o===a?e:o===n?d:null;return m(i)?null:p("td",{key:s},p(l,{...N(t,i,u),store:r,tableId:o,rowId:i,cellId:u}))})))},$=({thing:e,onThingChange:l,className:t,hasSchema:u,showType:i=!0})=>{const[m,h]=k(),[I,C]=k(),[g,T]=k(),[w,R]=k(),[f,S]=k();I!==e&&(h((e=>{const l=s(e);return(e=>e==a||e==n)(l)||l==o&&c(e)?l:void 0})(e)),C(e),T(e+""),R(Number(e)||0),S(!!e));const N=y(((e,t)=>{t(e),C(e),l(e)}),[l]),V=y((()=>{if(!u?.()){const e=b(m,o,n,a),t=b(e,g,w,f);h(e),C(t),l(t)}}),[u,l,g,w,f,m]);return p("div",{className:t},i?p("button",{className:m,onClick:V},m):null,b(m,p("input",{key:m,value:g,onChange:y((e=>N(e[r][d]+"",T)),[N])}),p("input",{key:m,type:"number",value:w,onChange:y((e=>N(Number(e[r][d]||0),R)),[N])}),p("input",{key:m,type:"checkbox",checked:f,onChange:y((e=>N(!!e[r].checked,S)),[N])})))},z=({tableId:e,rowId:t,cellId:s,store:a,className:n,showType:o})=>p($,{thing:l.useCell(e,t,s,a),onThingChange:l.useSetCellCallback(e,t,s,(e=>e),[],a),className:n??H+"Cell",showType:o,hasSchema:l.useStoreOrStoreById(a)?.hasTablesSchema}),G=({valueId:e,store:t,className:s,showType:a})=>p($,{thing:l.useValue(e,t),onThingChange:l.useSetValueCallback(e,(e=>e),[],t),className:s??H+u,showType:a,hasSchema:l.useStoreOrStoreById(t)?.hasValuesSchema}),J=({onChange:e,total:l,offset:t=0,limit:s=l,singular:a="row",plural:n=a+"s"})=>{(t>l||t<0)&&(t=0,e(0));const o=B((()=>e(t-s)),[e,t,s],t>0),u=B((()=>e(t+s)),[e,t,s],t+s<l);return p(I,null,l>s&&p(I,null,p("button",{className:"previous",disabled:0==t,onClick:o},"←"),p("button",{className:"next",disabled:t+s>=l,onClick:u},"→"),t+1," to ",i(l,t+s)," of "),l," ",1!=l?n:a)};e.EditableCellView=z,e.EditableValueView=G,e.RelationshipInHtmlTable=({relationshipId:e,relationships:t,editable:s,customCells:a,className:n,headerRow:o,idColumn:u=!0})=>{const[r,d,i,c]=((e,l)=>[e,e?.getStore(),e?.getLocalTableId(l),e?.getRemoteTableId(l)])(l.useRelationshipsOrRelationshipsById(t),e),m=L([...O(i,d),...O(c,d)],a,s?z:l.CellView),b=P(u,m,i,c,e,r,d);return p("table",{className:n},!1===o?null:p("thead",null,p("tr",null,!1===u?null:p(I,null,p("th",null,i,".Id"),p("th",null,c,".Id")),E(m,(({label:e},l)=>p("th",{key:l},e))))),p("tbody",null,V(l.useRowIds(i,d),(e=>p(D,{key:e,localRowId:e,params:b})))))},e.ResultSortedTableInHtmlTable=({queryId:e,cellId:t,descending:s,offset:a,limit:n,queries:o,sortOnClick:u,paginator:r=!1,customCells:d,onChange:i,...c})=>{const[m,b,h]=F(t,s,u,a,n,l.useResultRowCount(e,o),r,i);return p(M,{...c,params:P(L(l.useResultTableCellIds(e,o),d,l.ResultCellView),A(o,e),l.useResultSortedRowIds(e,...m,n,o),m,b,h)})},e.ResultTableInHtmlTable=({queryId:e,queries:t,customCells:s,...a})=>p(M,{...a,params:P(L(l.useResultTableCellIds(e,t),s,l.ResultCellView),A(t,e),l.useResultRowIds(e,t))}),e.SliceInHtmlTable=({indexId:e,sliceId:t,indexes:s,editable:a,customCells:n,...o})=>{const[u,r,d]=((e,l)=>[e,e?.getStore(),e?.getTableId(l)])(l.useIndexesOrIndexesById(s),e);return p(M,{...o,params:P(L(l.useTableCellIds(d,r),n,a?z:l.CellView),j(r,d),l.useSliceRowIds(e,t,u))})},e.SortedTableInHtmlTable=({tableId:e,cellId:t,descending:s,offset:a,limit:n,store:o,editable:u,sortOnClick:r,paginator:d=!1,onChange:i,customCells:c,...m})=>{const[b,h,I]=F(t,s,r,a,n,l.useRowCount(e,o),d,i);return p(M,{...m,params:P(L(l.useTableCellIds(e,o),c,u?z:l.CellView),j(o,e),l.useSortedRowIds(e,...b,n,o),b,h,I)})},e.SortedTablePaginator=J,e.TableInHtmlTable=({tableId:e,store:t,editable:s,customCells:a,...n})=>p(M,{...n,params:P(L(l.useTableCellIds(e,t),a,s?z:l.CellView),j(t,e),l.useRowIds(e,t))}),e.ValuesInHtmlTable=({store:e,editable:t=!1,valueComponent:s=(t?G:l.ValueView),getValueComponentProps:a,className:n,headerRow:o,idColumn:r})=>p("table",{className:n},!1===o?null:p("thead",null,p("tr",null,!1===r?null:p("th",null,"Id"),p("th",null,u))),p("tbody",null,V(l.useValueIds(e),(l=>p("tr",{key:l},!1===r?null:p("th",null,l),p("td",null,p(s,{...N(a,l),valueId:l,store:e})))))))},"object"==typeof exports&&"undefined"!=typeof module?l(exports,require("../../ui-react/with-schemas/index.js"),require("react")):"function"==typeof define&&define.amd?define(["exports","../ui-react","react"],l):l((e="undefined"!=typeof globalThis?globalThis:e||self).TinyBaseUiReactDom={},e.TinyBaseUiReact,e.React);
